{"ast":null,"code":"import _classCallCheck from\"C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _get from\"C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/node_modules/@babel/runtime/helpers/esm/get.js\";import _getPrototypeOf from\"C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";import _inherits from\"C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{updateState}from'../landing/Structure';import{renderCalendar,prevMonth,nextMonth}from'./KalenderDays';import KalenderPopup from'./KalenderPopup';import'../../css/kalender.css';import fetchPruefungen from'../../js/fetch';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var KalenderContent=/*#__PURE__*/function(_React$Component){_inherits(KalenderContent,_React$Component);var _super=_createSuper(KalenderContent);function KalenderContent(){var _this;_classCallCheck(this,KalenderContent);_this=_super.call(this);_this.state={error:null,isLoaded:true,pruefungen:[],aktiveFilter:[],pruefungPopup:false,searchItem:'',pruefungenInfos:[],calendar:[],date:new Date(),infos:[],dayShown:\"\"};updateState=updateState.bind(_assertThisInitialized(_this));return _this;}_createClass(KalenderContent,[{key:\"setState\",value:function setState(state){_get(_getPrototypeOf(KalenderContent.prototype),\"setState\",this).call(this,state);var calendar=renderCalendar(this.state.pruefungenInfos,this.state.date,this);this.state.calendar=calendar[0];this.state.date=calendar[1];}},{key:\"togglePopup\",value:function togglePopup(infos){//this.hideDayPopup();\nthis.setState({infos:infos,showPopup:!this.state.showPopup});}},{key:\"showDayPopup\",value:function showDayPopup(day){var dayPopup=document.querySelector(\"#dayPopup\");var dayPopupOuter=document.querySelector(\"#dayPopupOuter\");var dayTableCell=document.querySelector(\".\"+day);dayPopupOuter.classList.remove('inactive');this.setState({dayShown:day});var dayText=day.split(\"y\")[1].split(\"d\")[1].split(\"m\")[0]+\".\"+(parseInt(day.split(\"y\")[1].split(\"d\")[1].split(\"m\")[1])+1)+\".\"+day.split(\"y\")[1].split(\"d\")[0];dayPopup.innerHTML=\"<h3>\"+dayText+\"</h3><div id = event_list></div>\";while(typeof dayTableCell.childNodes[0]!='undefined'&&dayTableCell.childNodes[0]!='null'){dayPopup.childNodes[1].appendChild(dayTableCell.childNodes[0]);}}},{key:\"hideDayPopup\",value:function hideDayPopup(){console.log(\"empty\");var dayPopup=document.querySelector(\"#dayPopup\");var day=this.state.dayShown;var dayPopupOuter=document.querySelector(\"#dayPopupOuter\");var dayTableCell=document.querySelector(\".\"+day);while(typeof dayPopup.childNodes[1].childNodes[0]!='undefined'&&dayPopup.childNodes[1].childNodes[0]!='null'){dayTableCell.appendChild(dayPopup.childNodes[1].childNodes[0]);}dayPopupOuter.classList.add('inactive');}},{key:\"componentDidMount\",value:function componentDidMount(){fetchPruefungen(this);}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,error=_this$state.error,isLoaded=_this$state.isLoaded,pruefungen=_this$state.pruefungen;if(error){return/*#__PURE__*/_jsxs(\"div\",{children:[\"Error: \",error.message]});}else if(!isLoaded){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}else{var pruefungenHeader=[];var pruefungenInfos1=[];if(pruefungen[0]){var pruefungenKeys=Object.keys(pruefungen[0]);for(var i=1;i<pruefungenKeys.length;i++){pruefungenHeader.push(/*#__PURE__*/_jsx(\"td\",{style:{textTransform:\"capitalize\"},id:pruefungenKeys[i]+'_col_head',className:\"popup_cell\",children:/*#__PURE__*/_jsx(\"b\",{children:pruefungenKeys[i]})}));}for(var _i=0;_i<pruefungen.length;_i++){var pruefungenValues=Object.values(pruefungen[_i]);var filteredOut=false;var containsSearch=false;if(typeof pruefungen[_i].datum!=='undefined'&&!(pruefungen[_i].datum==null)){var datum=\"\";if(pruefungen[_i].datum.includes(\".\")){var tag=pruefungen[_i].datum.split(\".\")[0];var monat=pruefungen[_i].datum.split(\".\")[1];var jahr=pruefungen[_i].datum.split(\".\")[2];datum=monat+\"/\"+tag+\"/\"+jahr;}else{datum=pruefungen[_i].datum;}var pruefungDatum=new Date(datum);for(var j=1;j<pruefungenValues.length;j++){if(typeof this.state.aktiveFilter[j]!=\"undefined\"&&this.state.aktiveFilter[j]!=pruefungenValues[j]){filteredOut=true;}if(pruefungenValues[j]==null){pruefungenValues[j]=\"\";}if(pruefungenValues[j].toString().toLowerCase().match(this.state.searchItem.toLocaleLowerCase())){containsSearch=true;}}if(!filteredOut&&containsSearch){var _tag=pruefungDatum.getMonth()*31+pruefungDatum.getDate();if(typeof pruefungenInfos1[_tag]===\"undefined\"){pruefungenInfos1[_tag]=[];}var pruefungenInstance=[];for(var _j=1;_j<pruefungenKeys.length;_j++){//console.log(typeof(pruefungenValues[j]));\nif(pruefungenValues[_j].trim()===''){pruefungenInstance.push(/*#__PURE__*/_jsx(\"td\",{className:\"popup_cell\",children:\"NA\"}));}else{pruefungenInstance.push(/*#__PURE__*/_jsx(\"td\",{className:\"popup_cell\",children:pruefungenValues[_j]}));}}var included=false;var includedAt=-1;for(var k=0;k<pruefungenInfos1[_tag].length;k++){if(pruefungenInfos1[_tag][k][1]===pruefungen[_i].name){included=true;includedAt=k;}}if(!included){pruefungenInfos1[_tag].push([parseInt(pruefungDatum.getFullYear()),pruefungen[_i].name,[/*#__PURE__*/_jsx(\"tr\",{children:pruefungenInstance})]]);var calendar=renderCalendar(this.state.pruefungenInfos,this.state.date,this);this.state.calendar=calendar[0];this.state.date=calendar[1];}else{pruefungenInfos1[_tag][includedAt][2].push(/*#__PURE__*/_jsx(\"tr\",{children:pruefungenInstance}));}}}}}if(typeof this.state.pruefungenInfos[0]==='undefined'){this.state.pruefungenInfos=pruefungenInfos1;this.state.pruefungenInfos[0]=true;}else if(this.state.pruefungenInfos[0]){this.state.pruefungenInfos=pruefungenInfos1;this.setState();this.state.pruefungenInfos[0]=false;}else{this.state.pruefungenInfos=pruefungenInfos1;}}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"table\",{id:\"month\",children:/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"prev\",onClick:function onClick(){_this2.state.calendar=prevMonth(_this2.state.pruefungenInfos,_this2.state.date,_this2)[0];updateState(_this2.state.aktiveFilter,_this2.state.searchItem);},children:\"\\u276E\"}),/*#__PURE__*/_jsx(\"td\",{id:\"cur_month\",children:\"Monat wird errechnet\"}),/*#__PURE__*/_jsx(\"td\",{className:\"next\",onClick:function onClick(){_this2.state.calendar=nextMonth(_this2.state.pruefungenInfos,_this2.state.date,_this2)[0];updateState(_this2.state.aktiveFilter,_this2.state.searchItem);},children:\"\\u276F\"})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{}),/*#__PURE__*/_jsx(\"td\",{id:\"cur_year\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Jahr wird initialisiert\"})}),/*#__PURE__*/_jsx(\"td\",{})]})]})}),/*#__PURE__*/_jsxs(\"table\",{id:\"calendar_table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Mo\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Di\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Mi\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Do\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Fr\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Sa\"}),/*#__PURE__*/_jsx(\"th\",{children:\"So\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{id:\"days\",children:this.state.calendar})]}),/*#__PURE__*/_jsx(\"div\",{id:\"dayPopupOuter\",className:\"popup_outer inactive\",onClick:function onClick(){return _this2.hideDayPopup();},children:/*#__PURE__*/_jsxs(\"div\",{className:\"popup_inner\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return _this2.hideDayPopup();},children:\"\\u2715\"}),/*#__PURE__*/_jsx(\"div\",{id:\"dayPopup\"})]})}),this.state.showPopup?/*#__PURE__*/_jsx(KalenderPopup,{categories:pruefungenHeader,infos:this.state.infos,closePopup:this.togglePopup.bind(this)}):null]});}}]);return KalenderContent;}(React.Component);export{KalenderContent as default};","map":{"version":3,"sources":["C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/src/components/kalender/KalenderContent.jsx"],"names":["React","updateState","renderCalendar","prevMonth","nextMonth","KalenderPopup","fetchPruefungen","KalenderContent","state","error","isLoaded","pruefungen","aktiveFilter","pruefungPopup","searchItem","pruefungenInfos","calendar","date","Date","infos","dayShown","bind","setState","showPopup","day","dayPopup","document","querySelector","dayPopupOuter","dayTableCell","classList","remove","dayText","split","parseInt","innerHTML","childNodes","appendChild","console","log","add","message","pruefungenHeader","pruefungenInfos1","pruefungenKeys","Object","keys","i","length","push","textTransform","pruefungenValues","values","filteredOut","containsSearch","datum","includes","tag","monat","jahr","pruefungDatum","j","toString","toLowerCase","match","toLocaleLowerCase","getMonth","getDate","pruefungenInstance","trim","included","includedAt","k","name","getFullYear","hideDayPopup","togglePopup","Component"],"mappings":"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","sourcesContent":["\r\nimport React from 'react';\r\nimport { updateState } from '../landing/Structure';\r\nimport {renderCalendar, prevMonth, nextMonth} from './KalenderDays'\r\nimport KalenderPopup from './KalenderPopup';\r\nimport '../../css/kalender.css';\r\nimport fetchPruefungen from '../../js/fetch';\r\n\r\nexport default class KalenderContent extends React.Component{\r\n\r\n    constructor() {\r\n        super();\r\n        this.state = {\r\n            error:null,\r\n            isLoaded:true,\r\n            pruefungen: [],\r\n            aktiveFilter: [],\r\n            pruefungPopup: false,\r\n            searchItem: '',\r\n            pruefungenInfos: [],\r\n            calendar: [],\r\n            date: new Date(),\r\n            infos:[],\r\n            dayShown: \"\"\r\n        };\r\n        updateState = updateState.bind(this);\r\n    }\r\n\r\n    setState(state) {\r\n        super.setState(state);\r\n        var calendar = renderCalendar(this.state.pruefungenInfos, this.state.date, this);\r\n        this.state.calendar = calendar[0];\r\n        this.state.date = calendar[1];\r\n    }\r\n    \r\n    togglePopup(infos) {\r\n        //this.hideDayPopup();\r\n        this.setState({\r\n            infos: infos,\r\n            showPopup: !this.state.showPopup\r\n        });\r\n    }\r\n\r\n    showDayPopup(day) {\r\n\r\n        let dayPopup = document.querySelector(\"#dayPopup\");\r\n        let dayPopupOuter = document.querySelector(\"#dayPopupOuter\");\r\n        let dayTableCell = document.querySelector(\".\"+day);\r\n        dayPopupOuter.classList.remove('inactive');\r\n        this.setState({\r\n            dayShown: day\r\n        });        \r\n        let dayText =\r\n            day.split(\"y\")[1].split(\"d\")[1].split(\"m\")[0] + \".\" +\r\n            (parseInt(day.split(\"y\")[1].split(\"d\")[1].split(\"m\")[1]) + 1) + \".\" +\r\n            day.split(\"y\")[1].split(\"d\")[0] ;\r\n        dayPopup.innerHTML = \"<h3>\"+dayText+\"</h3><div id = event_list></div>\";\r\n        while(typeof(dayTableCell.childNodes[0]) != 'undefined' && dayTableCell.childNodes[0] != 'null') {\r\n            dayPopup.childNodes[1].appendChild(dayTableCell.childNodes[0]);\r\n        }\r\n    }\r\n\r\n    hideDayPopup() {\r\n        console.log(\"empty\");\r\n        let dayPopup = document.querySelector(\"#dayPopup\");\r\n        let day = this.state.dayShown;\r\n        let dayPopupOuter = document.querySelector(\"#dayPopupOuter\");\r\n        let dayTableCell = document.querySelector(\".\"+day);\r\n        while(typeof(dayPopup.childNodes[1].childNodes[0]) != 'undefined' && dayPopup.childNodes[1].childNodes[0]!= 'null') {\r\n            dayTableCell.appendChild(dayPopup.childNodes[1].childNodes[0]);\r\n        }\r\n        dayPopupOuter.classList.add('inactive');\r\n    }\r\n\r\n    componentDidMount() {\r\n        fetchPruefungen(this);\r\n    }\r\n\r\n    render() {\r\n\r\n\r\n        const { error, isLoaded, pruefungen} = this.state;\r\n        \r\n        if(error) {return <div>Error: {error.message}</div>}\r\n        else if(!isLoaded) {return <div>Loading...</div>}\r\n\r\n        else {\r\n\r\n            var pruefungenHeader = [];\r\n            var pruefungenInfos1 = [];\r\n\r\n            \r\n\r\n            if(pruefungen[0]){\r\n                var pruefungenKeys = Object.keys(pruefungen[0]);\r\n\r\n                for(let i = 1; i<pruefungenKeys.length; i++){\r\n                    \r\n                        pruefungenHeader.push(\r\n                        <td style = {{textTransform: \"capitalize\"}} \r\n                            id = {pruefungenKeys[i]+'_col_head'}\r\n                            className = \"popup_cell\">\r\n                                <b>{pruefungenKeys[i]}</b>\r\n                        </td>);                  \r\n                }\r\n\r\n                for(let i = 0; i<pruefungen.length; i++) {\r\n                    \r\n                    let pruefungenValues = Object.values(pruefungen[i]);\r\n                    let filteredOut = false;\r\n                    let containsSearch = false\r\n\r\n                    if (typeof(pruefungen[i].datum)!=='undefined'&&\r\n                        !(pruefungen[i].datum == null)) {\r\n                            let datum = \"\";\r\n                            if (pruefungen[i].datum.includes(\".\")) {\r\n                                let tag =  pruefungen[i].datum.split(\".\")[0];\r\n                                let monat =  pruefungen[i].datum.split(\".\")[1];\r\n                                let jahr =  pruefungen[i].datum.split(\".\")[2];\r\n                                datum = monat + \"/\" + tag + \"/\" + jahr;\r\n                            }\r\n                            else {\r\n                                datum = pruefungen[i].datum;\r\n                            }\r\n                            \r\n                        let pruefungDatum = new Date(datum);\r\n                            \r\n                        \r\n                        for(let j = 1; j<pruefungenValues.length; j++){\r\n                                                \r\n                            if(typeof(this.state.aktiveFilter[j])!=\"undefined\"&&this.state.aktiveFilter[j]!=pruefungenValues[j]){\r\n                                filteredOut = true;\r\n                            }\r\n                            if(pruefungenValues[j]==null){\r\n                                pruefungenValues[j]=\"\"\r\n                            }\r\n                            if(pruefungenValues[j].toString().toLowerCase().match(this.state.searchItem.toLocaleLowerCase())){\r\n                                containsSearch = true;\r\n                            }\r\n                        }\r\n                        \r\n                        if(!filteredOut&&containsSearch) {\r\n                            let tag = (pruefungDatum.getMonth())*31 + pruefungDatum.getDate();\r\n                            if (typeof(pruefungenInfos1[tag]) === \"undefined\") {\r\n                                pruefungenInfos1[tag] = [];\r\n                            }\r\n                            let pruefungenInstance = [];\r\n                            for (let j = 1; j<pruefungenKeys.length; j++){\r\n                                //console.log(typeof(pruefungenValues[j]));\r\n                                if (pruefungenValues[j].trim()==='') {\r\n                                    pruefungenInstance.push(<td className=\"popup_cell\">NA</td>);\r\n                                }\r\n                                else {\r\n                                    pruefungenInstance.push(<td className=\"popup_cell\">{pruefungenValues[j]}</td>);\r\n                                }\r\n                            }\r\n                      \r\n                            let included = false;\r\n                            let includedAt = -1;\r\n                            for(let k = 0; k<pruefungenInfos1[tag].length; k++){\r\n                                if(pruefungenInfos1[tag][k][1] === pruefungen[i].name) {\r\n                                    included = true;\r\n                                    includedAt = k;\r\n                                }\r\n                            }\r\n\r\n                            if (!included){\r\n                                pruefungenInfos1[tag].push([parseInt(pruefungDatum.getFullYear()), pruefungen[i].name, [<tr>{/*<td id = \"categorycontent\">*/}{pruefungenInstance}{/*</td>*/}</tr>]]);\r\n                                var calendar = renderCalendar(this.state.pruefungenInfos, this.state.date, this);\r\n                                this.state.calendar = calendar[0];\r\n                                this.state.date = calendar[1];\r\n                            }\r\n                            else {\r\n                                pruefungenInfos1[tag][includedAt][2].push(<tr>{/*<td id = \"categorycontent\">*/}{pruefungenInstance}{/*</td>*/}</tr>);\r\n                            }\r\n                           \r\n                        }\r\n                    }   \r\n                }\r\n            }  \r\n            \r\n            if(typeof(this.state.pruefungenInfos[0]) === 'undefined') {\r\n                this.state.pruefungenInfos = pruefungenInfos1;\r\n                this.state.pruefungenInfos[0] = true;\r\n            }\r\n            else if(this.state.pruefungenInfos[0]){\r\n                this.state.pruefungenInfos = pruefungenInfos1;\r\n                this.setState();\r\n                this.state.pruefungenInfos[0] = false;\r\n            }\r\n            else{\r\n                this.state.pruefungenInfos = pruefungenInfos1;\r\n            }\r\n            \r\n        }\r\n    \r\n        return(\r\n            <>\r\n            <table id = \"month\">\r\n                <tbody>\r\n                    <tr>\r\n                        <td className=\"prev\" onClick={()=>{\r\n                            this.state.calendar = prevMonth(this.state.pruefungenInfos, this.state.date, this)[0]; \r\n                            updateState(this.state.aktiveFilter, this.state.searchItem);\r\n                            }}>\r\n                        {'\\u276E'}\r\n                        </td>\r\n                        \r\n                        <td id = \"cur_month\">\r\n                            Monat wird errechnet\r\n                        </td>\r\n                        \r\n                        <td className=\"next\" onClick={()=>{\r\n                            this.state.calendar = nextMonth(this.state.pruefungenInfos, this.state.date, this)[0]; \r\n                            updateState(this.state.aktiveFilter, this.state.searchItem);\r\n                            }}>\r\n                            {'\\u276F'}\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td></td>\r\n                        <td id = \"cur_year\">\r\n                            <p>Jahr wird initialisiert</p>\r\n                        </td>\r\n                        <td></td>\r\n                        \r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n            <table id = \"calendar_table\">\r\n                <thead>\r\n                    <tr>\r\n                        <th>Mo</th>\r\n                        <th>Di</th>\r\n                        <th>Mi</th>\r\n                        <th>Do</th>\r\n                        <th>Fr</th>\r\n                        <th>Sa</th>\r\n                        <th>So</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody id = \"days\">\r\n                    {this.state.calendar}\r\n                    {/*Hier wird der Kalender generiert*/}\r\n                    {/*ToDo: Füllen der content divs mit Terminen*/}\r\n                </tbody>\r\n\r\n            </table>\r\n            \r\n            <div id = \"dayPopupOuter\" className= \"popup_outer inactive\" onClick={()=>this.hideDayPopup()}>\r\n                <div className= \"popup_inner\">\r\n                <button onClick={()=>this.hideDayPopup()}>{'\\u2715'}</button>\r\n                    <div id = \"dayPopup\">\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {this.state.showPopup ? \r\n            <KalenderPopup\r\n                categories={pruefungenHeader}\r\n                infos={this.state.infos}\r\n                closePopup={this.togglePopup.bind(this)}\r\n            />\r\n            : null\r\n            }\r\n\r\n            </>\r\n        );\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}