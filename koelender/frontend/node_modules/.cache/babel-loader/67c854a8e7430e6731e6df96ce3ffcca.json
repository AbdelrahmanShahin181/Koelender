{"ast":null,"code":"import _classCallCheck from\"C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{updateState}from'../landing/Structure';import'../../css/uebersicht.css';import fetchPruefungen from'../../js/fetch';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function SpaltenScript(){var columns_btn=document.querySelector('.hide_columns');var checkboxes=document.querySelector('#checkboxes');var outer_frame=document.querySelector('#outer_frame');columns_btn.classList.toggle('is-active');checkboxes.classList.toggle('is-active');outer_frame.classList.toggle('spalten-is-active');columns_btn.firstChild.data=columns_btn.firstChild.data===\"<\"?\"Spalten >\":\"<\";columns_btn.childNodes[1].data=\"\";}var KalenderContent=/*#__PURE__*/function(_React$Component){_inherits(KalenderContent,_React$Component);var _super=_createSuper(KalenderContent);function KalenderContent(){var _this;_classCallCheck(this,KalenderContent);_this=_super.call(this);_this.exportIcs=function(event){var blob=new Blob([event],{type:'text/plain;charset=utf-8'});var fileDownloadUrl=URL.createObjectURL(blob);_this.setState({fileDownloadUrl:fileDownloadUrl},function(){_this.dofileDownload.click();URL.revokeObjectURL(fileDownloadUrl);// free up storage--no longer needed.\n_this.setState({fileDownloadUrl:\"\"});});};_this.state={error:null,isLoaded:true,pruefungen:[],aktiveFilter:[],hiddenColumns:[],searchItem:'',fileDownloadUrl:\"\"};updateState=updateState.bind(_assertThisInitialized(_this));/*React.useEffect(() => {\r\n            childIcs.current = icsExport(this.pruefungenExport)\r\n        },[])*/return _this;}_createClass(KalenderContent,[{key:\"sethiddenCol\",value:function sethiddenCol(cols){window.localStorage.setItem('hiddenCols',JSON.stringify(cols));this.setState(cols);}},{key:\"componentDidMount\",value:function componentDidMount(){fetchPruefungen(this);if(JSON.parse(window.localStorage.getItem('hiddenCols'))){var cols=JSON.parse(window.localStorage.getItem('hiddenCols'));this.setState(cols);}}},{key:\"toIcsTime\",value:function toIcsTime(date){return date.getFullYear().toString()+(date.getMonth()+1<10?\"0\":\"\")+(date.getMonth()+1).toString()+(date.getDate()<10?\"0\":\"\")+date.getDate().toString()+\"T\"+(date.getHours()<10?\"0\":\"\")+date.getHours().toString()+(date.getMinutes()<10?\"0\":\"\")+date.getMinutes().toString()+\"00\";}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,error=_this$state.error,isLoaded=_this$state.isLoaded,pruefungen=_this$state.pruefungen,hiddenColumns=_this$state.hiddenColumns;if(error){return/*#__PURE__*/_jsxs(\"div\",{children:[\"Error: \",error.message]});}else if(!isLoaded){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}else{var pruefungenListe=[];var pruefungenHeader=[];var spaltenFilter=[];var pruefungenExport=\"BEGIN:VCALENDAR\\nPRODID:koelender.de\\nVERSION:2.0\";if(pruefungen[0]){var pruefungenKeys=Object.keys(pruefungen[0]);var x=0;var _loop=function _loop(i){if(!hiddenColumns[i]){pruefungenHeader.push(/*#__PURE__*/_jsx(\"td\",{style:{textTransform:\"capitalize\"},id:pruefungenKeys[i]+'_col_head',children:/*#__PURE__*/_jsx(\"b\",{children:pruefungenKeys[i]})}));}spaltenFilter.push(/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",className:\"show\",id:pruefungenKeys[i]+\"_col\",onChange:function onChange(){if(!hiddenColumns[i]){hiddenColumns[i]=true;_this2.sethiddenCol({hiddenColumns:hiddenColumns});}else{hiddenColumns[i]=null;_this2.sethiddenCol({hiddenColumns:hiddenColumns});}},defaultChecked:!hiddenColumns[i]}),/*#__PURE__*/_jsx(\"label\",{style:{textTransform:\"capitalize\"},children:pruefungenKeys[i]})]}));};for(var i=1;i<pruefungenKeys.length;i++){_loop(i);}for(var _i=0;_i<pruefungen.length;_i++){var pruefungenInstance=[];var pruefungenValues=Object.values(pruefungen[_i]);var filteredOut=false;var containsSearch=false;for(var j=1;j<pruefungenValues.length;j++){if(!hiddenColumns[j]){pruefungenInstance.push(/*#__PURE__*/_jsx(\"td\",{className:pruefungenKeys[j]+'_col',children:pruefungenValues[j]}));}if(this.state.aktiveFilter[j]!==undefined&&this.state.aktiveFilter[j]!==null&&this.state.aktiveFilter[j]!==pruefungenValues[j]){filteredOut=true;}if(pruefungenValues[j]==null){pruefungenValues[j]=\"Abdo\";}if(pruefungenValues[j].toString().toLowerCase().match(this.state.searchItem.toLocaleLowerCase())){containsSearch=true;}}if(!filteredOut&&containsSearch){var datum=\"\";if(pruefungen[_i].datum.includes(\".\")){var tag=pruefungen[_i].datum.split(\".\")[0];var monat=pruefungen[_i].datum.split(\".\")[1];var jahr=pruefungen[_i].datum.split(\".\")[2];datum=monat+\"/\"+tag+\"/\"+jahr;}else if(pruefungen[_i].datum.includes(\"-\")){var _jahr=pruefungen[_i].datum.split(\"-\")[0];var _monat=pruefungen[_i].datum.split(\"-\")[1];var _tag=pruefungen[_i].datum.split(\"-\")[2];datum=_monat+\"/\"+_tag+\"/\"+_jahr;}else{datum=pruefungen[_i].datum;}var pruefungStart=new Date(datum+\" \"+pruefungen[_i].startzeit);if(pruefungStart.getTime()===pruefungStart.getTime()){var pruefungEnd=new Date(datum+\" \"+pruefungen[_i].startzeit);if(pruefungen[_i].dauer.trim===\"\"){pruefungEnd.setMinutes(pruefungEnd.getMinutes()+parseInt(pruefungen[_i].dauer));}var timeStamp=new Date();pruefungenExport=\"\".concat(pruefungenExport,\"\\nBEGIN:VEVENT\\nUID:\").concat(pruefungen[_i].id,\"@koelender.de\\nLOCATION:\").concat(pruefungen[_i].pruefungsform,\"\\nSUMMARY:\").concat(pruefungen[_i].name,\"\\nDESCRIPTION:\").concat(pruefungen[_i].name+\"\\\\nStudiengang: \"+pruefungen[_i].studiengang+\"\\\\nSemester: \"+pruefungen[_i].semester+\"\\\\nPrüfer: \"+pruefungen[_i].pruefer,\"\\nDTSTART;VALUE=DATE-TIME:\").concat(this.toIcsTime(pruefungStart),\"\\nDTEND;VALUE=DATE-TIME:\").concat(this.toIcsTime(pruefungEnd),\"\\nDTSTAMP;VALUE=DATE-TIME:\").concat(this.toIcsTime(timeStamp),\"\\nEND:VEVENT\");}if(x%2===1){pruefungenListe.push(/*#__PURE__*/_jsx(\"tr\",{className:\"second\",children:pruefungenInstance}));}else{pruefungenListe.push(/*#__PURE__*/_jsx(\"tr\",{children:pruefungenInstance}));}x++;}}pruefungenExport=pruefungenExport+\"\\nEND:VCALENDAR\";this.state.pruefungenExport=pruefungenExport;}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{className:\"hide_columns\",onClick:function onClick(){return SpaltenScript();},children:[\"Spalte \",\">\"]}),/*#__PURE__*/_jsx(\"div\",{id:\"checkboxes\",className:\"sidenav\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"h3\",{id:\"spaltenHeader\",children:\"Spalten\"})}),spaltenFilter]})}),/*#__PURE__*/_jsxs(\"div\",{id:\"ov_content\",children:[/*#__PURE__*/_jsx(\"a\",{style:{display:\"none\"},download:\"koelender.ics\",href:this.state.fileDownloadUrl,ref:function ref(e){return _this2.dofileDownload=e;},children:\"download it\"}),/*#__PURE__*/_jsx(\"button\",{id:\"export_btn\",onClick:function onClick(){return _this2.exportIcs(pruefungenExport.replace(' ','').replace(\"\\\\t\",\"\"));},children:\"Export\"}),/*#__PURE__*/_jsx(\"h3\",{id:\"header_overview\",children:\"\\xDCbersicht\"}),/*#__PURE__*/_jsxs(\"table\",{id:\"overview_table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:pruefungenHeader})}),/*#__PURE__*/_jsx(\"tbody\",{children:pruefungenListe})]})]})]});}}}]);return KalenderContent;}(React.Component);export{KalenderContent as default};","map":{"version":3,"sources":["C:/Users/Franzi/Desktop/Koelender/WebTech2/koelender/frontend/src/components/uebersicht/UebersichtContent.jsx"],"names":["React","updateState","fetchPruefungen","SpaltenScript","columns_btn","document","querySelector","checkboxes","outer_frame","classList","toggle","firstChild","data","childNodes","KalenderContent","exportIcs","event","blob","Blob","type","fileDownloadUrl","URL","createObjectURL","setState","dofileDownload","click","revokeObjectURL","state","error","isLoaded","pruefungen","aktiveFilter","hiddenColumns","searchItem","bind","cols","window","localStorage","setItem","JSON","stringify","parse","getItem","date","getFullYear","toString","getMonth","getDate","getHours","getMinutes","message","pruefungenListe","pruefungenHeader","spaltenFilter","pruefungenExport","pruefungenKeys","Object","keys","x","i","push","textTransform","sethiddenCol","length","pruefungenInstance","pruefungenValues","values","filteredOut","containsSearch","j","undefined","toLowerCase","match","toLocaleLowerCase","datum","includes","tag","split","monat","jahr","pruefungStart","Date","startzeit","getTime","pruefungEnd","dauer","trim","setMinutes","parseInt","timeStamp","id","pruefungsform","name","studiengang","semester","pruefer","toIcsTime","display","e","replace","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { updateState } from '../landing/Structure';\r\nimport '../../css/uebersicht.css';\r\nimport fetchPruefungen from '../../js/fetch';\r\n\r\nfunction SpaltenScript() {\r\n    const columns_btn = document.querySelector('.hide_columns');\r\n    const checkboxes = document.querySelector('#checkboxes');\r\n    const outer_frame = document.querySelector('#outer_frame');\r\n\r\n    columns_btn.classList.toggle('is-active');\r\n    checkboxes.classList.toggle('is-active');\r\n    outer_frame.classList.toggle('spalten-is-active');\r\n\r\n    columns_btn.firstChild.data = columns_btn.firstChild.data === \"<\" ? \"Spalten >\" : \"<\";\r\n    columns_btn.childNodes[1].data = \"\";\r\n}\r\n\r\nexport default class KalenderContent extends React.Component{\r\n\r\n    constructor() {\r\n        super();\r\n        this.state = {\r\n            error:null,\r\n            isLoaded:true,\r\n            pruefungen: [],\r\n            aktiveFilter: [],\r\n            hiddenColumns: [],\r\n            searchItem: '',\r\n            fileDownloadUrl: \"\",\r\n        };\r\n        updateState = updateState.bind(this);\r\n        /*React.useEffect(() => {\r\n            childIcs.current = icsExport(this.pruefungenExport)\r\n        },[])*/\r\n    }\r\n\r\n    sethiddenCol(cols) {\r\n        window.localStorage.setItem('hiddenCols', JSON.stringify(cols));\r\n        this.setState(cols);\r\n    }\r\n\r\n    componentDidMount() {\r\n        fetchPruefungen(this)\r\n        if(JSON.parse(window.localStorage.getItem('hiddenCols'))) {\r\n            var cols = JSON.parse(window.localStorage.getItem('hiddenCols'));\r\n            this.setState(cols);\r\n        }\r\n    }\r\n    \r\n    toIcsTime(date) {\r\n        return(\r\n        date.getFullYear().toString()+\r\n        ((date.getMonth() + 1)<10? \"0\":\"\") +\r\n        (date.getMonth()+1).toString()+\r\n        (date.getDate()<10? \"0\":\"\") +\r\n        date.getDate().toString()+\r\n        \"T\"+\r\n        (date.getHours()<10? \"0\":\"\") +\r\n        date.getHours().toString()+\r\n        (date.getMinutes()<10? \"0\":\"\") +\r\n        date.getMinutes().toString()+\r\n        \"00\")\r\n    }\r\n\r\n    exportIcs = (event) => {\r\n        const blob = new Blob([event],{type: 'text/plain;charset=utf-8',})\r\n        const fileDownloadUrl = URL.createObjectURL(blob);\r\n        this.setState ({fileDownloadUrl: fileDownloadUrl}, \r\n        () => {\r\n            this.dofileDownload.click(); \r\n            URL.revokeObjectURL(fileDownloadUrl);  // free up storage--no longer needed.\r\n            this.setState({fileDownloadUrl: \"\"})\r\n        })   \r\n    }\r\n\r\n    render() {\r\n\r\n        const { error, isLoaded, pruefungen, hiddenColumns} = this.state;\r\n        \r\n        if(error) {return <div>Error: {error.message}</div>}\r\n        else if(!isLoaded) {return <div>Loading...</div>}\r\n\r\n        else {\r\n\r\n            var pruefungenListe = [];\r\n            var pruefungenHeader = [];\r\n            var spaltenFilter = [];\r\n            var pruefungenExport = \r\n                \"BEGIN:VCALENDAR\\nPRODID:koelender.de\\nVERSION:2.0\";\r\n\r\n            if(pruefungen[0]){\r\n                var pruefungenKeys = Object.keys(pruefungen[0]);\r\n                let x = 0;\r\n\r\n                for(let i = 1; i<pruefungenKeys.length; i++){\r\n                    if (!hiddenColumns[i]){\r\n                        pruefungenHeader.push(\r\n                        <td style = {{textTransform: \"capitalize\"}} \r\n                            id = {pruefungenKeys[i]+'_col_head'}>\r\n                                <b>{pruefungenKeys[i]}</b>\r\n                        </td>);\r\n                    }\r\n                    spaltenFilter.push(\r\n                    <li>\r\n                        <input type=\"checkbox\" \r\n                            className=\"show\" \r\n                            id={pruefungenKeys[i]+\"_col\"} \r\n                            onChange={()=> {                                \r\n                                if(!hiddenColumns[i] )\r\n                                {   \r\n                                    hiddenColumns[i] = true;\r\n                                    this.sethiddenCol({hiddenColumns});\r\n                                }\r\n\r\n                                else\r\n                                {\r\n                                    hiddenColumns[i] = null;\r\n                                    this.sethiddenCol({hiddenColumns});\r\n                                }\r\n                            }\r\n                            } \r\n                            defaultChecked={!hiddenColumns[i]}/>\r\n                        <label style = {{textTransform: \"capitalize\"}}>{pruefungenKeys[i]}</label>\r\n                    </li>);\r\n                    \r\n                \r\n                }\r\n\r\n                for(let i = 0; i<pruefungen.length; i++) {\r\n                    var pruefungenInstance = [];\r\n                    let pruefungenValues = Object.values(pruefungen[i]);\r\n                    let filteredOut = false;\r\n                    let containsSearch = false\r\n            \r\n                    for(let j = 1; j<pruefungenValues.length; j++){\r\n                        \r\n                        if(!hiddenColumns[j]) {\r\n                            pruefungenInstance.push(<td className = {pruefungenKeys[j]+'_col'}>{pruefungenValues[j]}</td>);\r\n                        }\r\n                        \r\n                        if(this.state.aktiveFilter[j]!==undefined&&this.state.aktiveFilter[j]!==null&&this.state.aktiveFilter[j]!==pruefungenValues[j]){\r\n                            filteredOut = true;\r\n                        }\r\n                        if(pruefungenValues[j]==null){\r\n                            pruefungenValues[j]=\"Abdo\"\r\n                        }\r\n                        if(pruefungenValues[j].toString().toLowerCase().match(this.state.searchItem.toLocaleLowerCase())){\r\n                            containsSearch = true;\r\n                        }\r\n                    }\r\n                    \r\n                    if(!filteredOut&&containsSearch) {\r\n\r\n                        let datum = \"\";\r\n                        if (pruefungen[i].datum.includes(\".\")) {\r\n                            let tag =  pruefungen[i].datum.split(\".\")[0];\r\n                            let monat =  pruefungen[i].datum.split(\".\")[1];\r\n                            let jahr =  pruefungen[i].datum.split(\".\")[2];\r\n                            datum = monat + \"/\" + tag + \"/\" + jahr;\r\n                        }\r\n                        else if (pruefungen[i].datum.includes(\"-\")) {\r\n                            let jahr =  pruefungen[i].datum.split(\"-\")[0];\r\n                            let monat =  pruefungen[i].datum.split(\"-\")[1];\r\n                            let tag =  pruefungen[i].datum.split(\"-\")[2];\r\n                            datum = monat + \"/\" + tag + \"/\" + jahr;\r\n                        }\r\n                        else {\r\n                            datum = pruefungen[i].datum;\r\n                        }\r\n                        \r\n                        var pruefungStart = new Date(datum+\" \"+pruefungen[i].startzeit);\r\n                        if(pruefungStart.getTime() === pruefungStart.getTime()){\r\n                        var pruefungEnd = new Date(datum+\" \"+pruefungen[i].startzeit);\r\n                        if(pruefungen[i].dauer.trim === \"\"){\r\n                            pruefungEnd.setMinutes(pruefungEnd.getMinutes()+parseInt(pruefungen[i].dauer));\r\n                        }\r\n                        var timeStamp = new Date();\r\n                        \r\n                        \r\n                        pruefungenExport = `${pruefungenExport}\\\r\n\\nBEGIN:VEVENT\\\r\n\\nUID:${pruefungen[i].id}@koelender.de\\\r\n\\nLOCATION:${pruefungen[i].pruefungsform}\\\r\n\\nSUMMARY:${pruefungen[i].name}\\\r\n\\nDESCRIPTION:${pruefungen[i].name + \r\n\"\\\\nStudiengang: \" + pruefungen[i].studiengang + \r\n\"\\\\nSemester: \" + pruefungen[i].semester +\r\n\"\\\\nPrüfer: \" + pruefungen[i].pruefer}\\\r\n\\nDTSTART;VALUE=DATE-TIME:${this.toIcsTime(pruefungStart)}\\\r\n\\nDTEND;VALUE=DATE-TIME:${this.toIcsTime(pruefungEnd)}\\\r\n\\nDTSTAMP;VALUE=DATE-TIME:${this.toIcsTime(timeStamp)}\\\r\n\\nEND:VEVENT`;\r\n                        }\r\n                        \r\n                        if(x%2===1){\r\n                            pruefungenListe.push(<tr className = 'second'>{pruefungenInstance}</tr>)\r\n                        } else {\r\n                            pruefungenListe.push(<tr>{pruefungenInstance}</tr>)\r\n                        }\r\n                        x++;\r\n                    }\r\n                }\r\n                pruefungenExport = pruefungenExport+\"\\nEND:VCALENDAR\";\r\n                this.state.pruefungenExport = pruefungenExport;\r\n                \r\n            }  \r\n            \r\n           \r\n\r\n            return(\r\n                <>\r\n                <button className=\"hide_columns\" onClick={()=>SpaltenScript()}>Spalte {'\\u003E'}</button>\r\n                <div id=\"checkboxes\" className = \"sidenav\">\r\n                    <ul>\r\n                        <li>\r\n                            <h3 id=\"spaltenHeader\">Spalten</h3>\r\n                        </li>\r\n                        {spaltenFilter}\r\n                        {/*Hier werden die Spaltenfilter generiert*/}\r\n                    </ul>\r\n                </div>\r\n\r\n                <div id = \"ov_content\">\r\n\r\n                    <a style={{display: \"none\"}}\r\n                        download=\"koelender.ics\"\r\n                        href={this.state.fileDownloadUrl}\r\n                        ref={e=>this.dofileDownload = e}\r\n                    >download it</a>\r\n\r\n                    <button id = \"export_btn\" onClick={()=>this.exportIcs(pruefungenExport.replace(' ', '').replace(\"\\\\t\", \"\"))}>Export</button>\r\n                    \r\n                    <h3 id = \"header_overview\">Übersicht</h3>\r\n\r\n                    <table id = \"overview_table\">\r\n                        <thead>\r\n                            <tr>\r\n                                {pruefungenHeader}\r\n                                {/*ToDo: Hier werden die Spaltennamen generiert*/}\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {/*<tr>{this.state.aktiveFilter}</tr>}\r\n                            {<tr>{this.state.searchItem}</tr>*/}\r\n                            {pruefungenListe}\r\n                            {/*rows*/}\r\n                        </tbody>\r\n\r\n                    </table>\r\n                </div>  \r\n                </>\r\n            );\r\n        }\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}