{"ast":null,"code":"import _classCallCheck from\"/home/malte/Documents/WT2-Projekt/koelender_git/koelender/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/malte/Documents/WT2-Projekt/koelender_git/koelender/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/home/malte/Documents/WT2-Projekt/koelender_git/koelender/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/home/malte/Documents/WT2-Projekt/koelender_git/koelender/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/malte/Documents/WT2-Projekt/koelender_git/koelender/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{updateState}from'../landing/Structure';import'../../css/uebersicht.css';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function SpaltenScript(){var columns_btn=document.querySelector('.hide_columns');var checkboxes=document.querySelector('#checkboxes');var outer_frame=document.querySelector('#outer_frame');columns_btn.classList.toggle('is-active');checkboxes.classList.toggle('is-active');outer_frame.classList.toggle('spalten-is-active');columns_btn.firstChild.data=columns_btn.firstChild.data===\"<\"?\"Spalten >\":\"<\";columns_btn.childNodes[1].data=\"\";}var KalenderContent=/*#__PURE__*/function(_React$Component){_inherits(KalenderContent,_React$Component);var _super=_createSuper(KalenderContent);function KalenderContent(){var _this;_classCallCheck(this,KalenderContent);_this=_super.call(this);_this.state={error:null,isLoaded:true,pruefungen:[],aktiveFilter:[],hiddenColumns:[],searchItem:'',fileDownloadUrl:\"\"};updateState=updateState.bind(_assertThisInitialized(_this));return _this;}_createClass(KalenderContent,[{key:\"sethiddenCol\",value:function sethiddenCol(cols){window.localStorage.setItem('hiddenCols',JSON.stringify(cols));this.setState(cols);}},{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch(\"http://192.168.0.105:8000/api/liste/\",{method:'GET',headers:{'Content-Type':'application/json'}}).then(function(response){return response.json();}).then(function(result){_this2.setState({isLoaded:true,pruefungen:result});},function(error){_this2.setState({isLoaded:true,error:error});});if(JSON.parse(window.localStorage.getItem('hiddenCols'))){var cols=JSON.parse(window.localStorage.getItem('hiddenCols'));this.setState(cols);}}},{key:\"toIcsTime\",value:function toIcsTime(date){return date.getFullYear().toString()+(date.getMonth()+1<10?\"0\":\"\")+(date.getMonth()+1).toString()+(date.getDate()<10?\"0\":\"\")+date.getDate().toString()+\"T\"+date.getHours().toString()+date.getMinutes().toString()+\"00\"+\"Z\";}},{key:\"exportIcs\",value:function exportIcs(event){var _this3=this;console.log(event);var blob=new Blob([event],{type:\"text/plain\"});var fileDownloadUrl=URL.createObjectURL(blob);this.setState({fileDownloadUrl:fileDownloadUrl},function(){_this3.dofileDownload.click();URL.revokeObjectURL(fileDownloadUrl);// free up storage--no longer needed.\n_this3.setState({fileDownloadUrl:\"\"});});}},{key:\"render\",value:function render(){var _this4=this;var _this$state=this.state,error=_this$state.error,isLoaded=_this$state.isLoaded,pruefungen=_this$state.pruefungen,hiddenColumns=_this$state.hiddenColumns;if(error){return/*#__PURE__*/_jsxs(\"div\",{children:[\"Error: \",error.message]});}else if(!isLoaded){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}else{var pruefungenListe=[];var pruefungenHeader=[];var spaltenFilter=[];var pruefungenExport=\"BEGIN:VCALENDER \\\n                VERSION:2.0 \\\n                PRODID:koelender.de \\\n                METHOD: PUBLISH\";if(pruefungen[0]){var pruefungenKeys=Object.keys(pruefungen[0]);var x=0;var _loop=function _loop(i){if(!hiddenColumns[i]){pruefungenHeader.push(/*#__PURE__*/_jsx(\"td\",{style:{textTransform:\"capitalize\"},id:pruefungenKeys[i]+'_col_head',children:/*#__PURE__*/_jsx(\"b\",{children:pruefungenKeys[i]})}));}spaltenFilter.push(/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",className:\"show\",id:pruefungenKeys[i]+\"_col\",onChange:function onChange(){var col_name=pruefungenKeys[i]+\"_col\";var checkbox_val=document.getElementById(col_name).className;if(!hiddenColumns[i]){hiddenColumns[i]=true;_this4.sethiddenCol({hiddenColumns:hiddenColumns});}else{hiddenColumns[i]=null;_this4.sethiddenCol({hiddenColumns:hiddenColumns});}},defaultChecked:!hiddenColumns[i]}),/*#__PURE__*/_jsx(\"label\",{style:{textTransform:\"capitalize\"},children:pruefungenKeys[i]})]}));};for(var i=1;i<pruefungenKeys.length;i++){_loop(i);}for(var _i=0;_i<pruefungen.length;_i++){var pruefungenInstance=[];var pruefungenValues=Object.values(pruefungen[_i]);var filteredOut=false;var containsSearch=false;for(var j=1;j<pruefungenValues.length;j++){if(!hiddenColumns[j]){pruefungenInstance.push(/*#__PURE__*/_jsx(\"td\",{className:pruefungenKeys[j]+'_col',children:pruefungenValues[j]}));}if(this.state.aktiveFilter[j]!==undefined&&this.state.aktiveFilter[j]!=pruefungenValues[j]){filteredOut=true;}if(pruefungenValues[j]==null){pruefungenValues[j]=\"Abdo\";}if(pruefungenValues[j].toString().toLowerCase().match(this.state.searchItem.toLocaleLowerCase())){containsSearch=true;}}if(!filteredOut&&containsSearch){var pruefungStart=new Date(pruefungen[_i].datum+\" \"+pruefungen[_i].startzeit);var pruefungEnd=new Date(pruefungen[_i].datum+\" \"+pruefungen[_i].startzeit);pruefungEnd.setMinutes(pruefungEnd.getMinutes()+parseInt(pruefungen[_i].dauer));var timeStamp=new Date();pruefungenExport=\"\".concat(pruefungenExport,\"                            BEGIN:VEVENT                             UID:\").concat(pruefungen[_i].id,\"                            LOCATION:Raum                            SUMMARY:\").concat(pruefungen[_i].name,\"                            DESCRIPTION:\").concat(pruefungen[_i].name+\" \"+pruefungen[_i].studiengang+\" \"+\"bei: \"+pruefungen[_i].pruefer,\"                            CLASS:PUBLIC                            DTSTART:\").concat(this.toIcsTime(pruefungStart),\"                            DTEND:\").concat(this.toIcsTime(pruefungEnd),\"                            DTSTAMP:\").concat(this.toIcsTime(timeStamp),\"                            END:VEVENT\");if(x%2===1){pruefungenListe.push(/*#__PURE__*/_jsx(\"tr\",{className:\"second\",children:pruefungenInstance}));}else{pruefungenListe.push(/*#__PURE__*/_jsx(\"tr\",{children:pruefungenInstance}));}x++;}}pruefungenExport=pruefungenExport+\"\\\n                END:VCALENDAR\";//console.log(typeof(pruefungenListe));\n}console.log(pruefungenExport);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{className:\"hide_columns\",onClick:function onClick(){return SpaltenScript();},children:[\"Spalte \",\">\"]}),/*#__PURE__*/_jsx(\"div\",{id:\"checkboxes\",className:\"sidenav\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"h3\",{id:\"spaltenHeader\",children:\"Spalten\"})}),spaltenFilter]})}),/*#__PURE__*/_jsxs(\"div\",{id:\"ov_content\",children:[/*#__PURE__*/_jsx(\"a\",{style:{display:\"none\"},download:\"koelender.ics\",href:this.state.fileDownloadUrl,ref:function ref(e){return _this4.dofileDownload=e;},children:\"download it\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return _this4.exportIcs(pruefungenExport.replace(\" \",\"\"));},children:\"Export\"}),/*#__PURE__*/_jsx(\"h3\",{id:\"header_overview\",children:\"\\xDCbersicht\"}),/*#__PURE__*/_jsxs(\"table\",{id:\"overview_table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:pruefungenHeader})}),/*#__PURE__*/_jsx(\"tbody\",{children:pruefungenListe})]})]})]});}}}]);return KalenderContent;}(React.Component);export{KalenderContent as default};","map":{"version":3,"sources":["/home/malte/Documents/WT2-Projekt/koelender_git/koelender/frontend/src/components/uebersicht/UebersichtContent.jsx"],"names":["React","updateState","SpaltenScript","columns_btn","document","querySelector","checkboxes","outer_frame","classList","toggle","firstChild","data","childNodes","KalenderContent","state","error","isLoaded","pruefungen","aktiveFilter","hiddenColumns","searchItem","fileDownloadUrl","bind","cols","window","localStorage","setItem","JSON","stringify","setState","fetch","method","headers","then","response","json","result","parse","getItem","date","getFullYear","toString","getMonth","getDate","getHours","getMinutes","event","console","log","blob","Blob","type","URL","createObjectURL","dofileDownload","click","revokeObjectURL","message","pruefungenListe","pruefungenHeader","spaltenFilter","pruefungenExport","pruefungenKeys","Object","keys","x","i","push","textTransform","col_name","checkbox_val","getElementById","className","sethiddenCol","length","pruefungenInstance","pruefungenValues","values","filteredOut","containsSearch","j","undefined","toLowerCase","match","toLocaleLowerCase","pruefungStart","Date","datum","startzeit","pruefungEnd","setMinutes","parseInt","dauer","timeStamp","id","name","studiengang","pruefer","toIcsTime","display","e","exportIcs","replace","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { updateState } from '../landing/Structure';\nimport '../../css/uebersicht.css';\n\nfunction SpaltenScript() {\n    const columns_btn = document.querySelector('.hide_columns');\n    const checkboxes = document.querySelector('#checkboxes');\n    const outer_frame = document.querySelector('#outer_frame');\n\n    columns_btn.classList.toggle('is-active');\n    checkboxes.classList.toggle('is-active');\n    outer_frame.classList.toggle('spalten-is-active');\n\n    columns_btn.firstChild.data = columns_btn.firstChild.data === \"<\" ? \"Spalten >\" : \"<\";\n    columns_btn.childNodes[1].data = \"\";\n}\n\nexport default class KalenderContent extends React.Component{\n\n    constructor() {\n        super();\n        this.state = {\n            error:null,\n            isLoaded:true,\n            pruefungen: [],\n            aktiveFilter: [],\n            hiddenColumns: [],\n            searchItem: '',\n            fileDownloadUrl: \"\"\n        };\n        \n        updateState = updateState.bind(this);\n    }\n\n    sethiddenCol(cols) {\n        window.localStorage.setItem('hiddenCols', JSON.stringify(cols));\n        this.setState(cols);\n    }\n\n    componentDidMount() {\n        fetch(\"http://192.168.0.105:8000/api/liste/\",{\n            method:'GET',\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        })\n        .then(response => response.json())\n        \n        .then(\n            (result) => {\n                this.setState({\n                    isLoaded: true,\n                    pruefungen: result,\n                    \n                });\n            },\n            (error) => {\n                this.setState({\n                    isLoaded: true,\n                    error\n                });\n            }\n        );\n        if(JSON.parse(window.localStorage.getItem('hiddenCols'))) {\n            var cols = JSON.parse(window.localStorage.getItem('hiddenCols'));\n            this.setState(cols);\n        }\n    }\n    \n    toIcsTime(date) {\n        return(\n        date.getFullYear().toString()+\n        ((date.getMonth() + 1)<10? \"0\":\"\") +\n        (date.getMonth()+1).toString()+\n        (date.getDate()<10? \"0\":\"\") +\n        date.getDate().toString()+\n        \"T\"+\n        date.getHours().toString()+\n        date.getMinutes().toString()+\n        \"00\"+\n        \"Z\")\n    }\n\n    exportIcs(event) {\n        console.log(event);\n        const blob = new Blob([event],{type: \"text/plain\"})\n        const fileDownloadUrl = URL.createObjectURL(blob);\n        this.setState ({fileDownloadUrl: fileDownloadUrl}, \n        () => {\n            this.dofileDownload.click(); \n            URL.revokeObjectURL(fileDownloadUrl);  // free up storage--no longer needed.\n            this.setState({fileDownloadUrl: \"\"})\n        })   \n    }\n    \n\n    render() {\n\n        const { error, isLoaded, pruefungen, hiddenColumns} = this.state;\n        \n        if(error) {return <div>Error: {error.message}</div>}\n        else if(!isLoaded) {return <div>Loading...</div>}\n\n        else {\n\n            var pruefungenListe = [];\n            var pruefungenHeader = [];\n            var spaltenFilter = [];\n            var pruefungenExport = \n                \"BEGIN:VCALENDER \\\n                VERSION:2.0 \\\n                PRODID:koelender.de \\\n                METHOD: PUBLISH\";\n\n            if(pruefungen[0]){\n                var pruefungenKeys = Object.keys(pruefungen[0]);\n                let x = 0;\n\n                for(let i = 1; i<pruefungenKeys.length; i++){\n                    if (!hiddenColumns[i]){\n                        pruefungenHeader.push(\n                        <td style = {{textTransform: \"capitalize\"}} \n                            id = {pruefungenKeys[i]+'_col_head'}>\n                                <b>{pruefungenKeys[i]}</b>\n                        </td>);\n                    }\n                    spaltenFilter.push(\n                    <li>\n                        <input type=\"checkbox\" \n                            className=\"show\" \n                            id={pruefungenKeys[i]+\"_col\"} \n                            onChange={()=> {\n                                var col_name = pruefungenKeys[i]+\"_col\";\n                                var checkbox_val=document.getElementById(col_name).className;\n                                if(!hiddenColumns[i] )\n                                {   \n                                    hiddenColumns[i] = true;\n                                    this.sethiddenCol({hiddenColumns});\n                                }\n\n                                else\n                                {\n                                    hiddenColumns[i] = null;\n                                    this.sethiddenCol({hiddenColumns});\n                                }\n                            }\n                            } \n                            defaultChecked={!hiddenColumns[i]}/>\n                        <label style = {{textTransform: \"capitalize\"}}>{pruefungenKeys[i]}</label>\n                    </li>);\n                    \n                \n                }\n\n                for(let i = 0; i<pruefungen.length; i++) {\n                    var pruefungenInstance = [];\n                    let pruefungenValues = Object.values(pruefungen[i]);\n                    let filteredOut = false;\n                    let containsSearch = false\n            \n                    for(let j = 1; j<pruefungenValues.length; j++){\n                        \n                        if(!hiddenColumns[j]) {\n                            pruefungenInstance.push(<td className = {pruefungenKeys[j]+'_col'}>{pruefungenValues[j]}</td>);\n                        }\n                        \n                        if(this.state.aktiveFilter[j]!==undefined&&this.state.aktiveFilter[j]!=pruefungenValues[j]){\n                            filteredOut = true;\n                        }\n                        if(pruefungenValues[j]==null){\n                            pruefungenValues[j]=\"Abdo\"\n                        }\n                        if(pruefungenValues[j].toString().toLowerCase().match(this.state.searchItem.toLocaleLowerCase())){\n                            containsSearch = true;\n                        }\n                    }\n                    \n                    if(!filteredOut&&containsSearch) {\n                        \n                        var pruefungStart = new Date(pruefungen[i].datum+\" \"+pruefungen[i].startzeit);\n                        var pruefungEnd = new Date(pruefungen[i].datum+\" \"+pruefungen[i].startzeit);\n                        pruefungEnd.setMinutes(pruefungEnd.getMinutes()+parseInt(pruefungen[i].dauer));\n                        var timeStamp = new Date();\n                        \n                        \n                        pruefungenExport = `${pruefungenExport}\\\n                            BEGIN:VEVENT \\\n                            UID:${pruefungen[i].id}\\\n                            LOCATION:Raum\\\n                            SUMMARY:${pruefungen[i].name}\\\n                            DESCRIPTION:${pruefungen[i].name + \" \" +\n                                pruefungen[i].studiengang + \" \" +\n                                \"bei: \" + pruefungen[i].pruefer}\\\n                            CLASS:PUBLIC\\\n                            DTSTART:${this.toIcsTime(pruefungStart)}\\\n                            DTEND:${this.toIcsTime(pruefungEnd)}\\\n                            DTSTAMP:${this.toIcsTime(timeStamp)}\\\n                            END:VEVENT`;\n                        \n                        if(x%2===1){\n                            pruefungenListe.push(<tr className = 'second'>{pruefungenInstance}</tr>)\n                        } else {\n                            pruefungenListe.push(<tr>{pruefungenInstance}</tr>)\n                        }\n                        x++;\n                    }\n                }\n                pruefungenExport = pruefungenExport+\"\\\n                END:VCALENDAR\";\n                \n                //console.log(typeof(pruefungenListe));\n                \n            }  \n            \n            console.log(pruefungenExport);\n\n            return(\n                <>\n                <button className=\"hide_columns\" onClick={()=>SpaltenScript()}>Spalte {'\\u003E'}</button>\n                <div id=\"checkboxes\" className = \"sidenav\">\n                    <ul>\n                        <li>\n                            <h3 id=\"spaltenHeader\">Spalten</h3>\n                        </li>\n                        {spaltenFilter}\n                        {/*Hier werden die Spaltenfilter generiert*/}\n                    </ul>\n                </div>\n\n                <div id = \"ov_content\">\n                    <a style={{display: \"none\"}}\n                        download=\"koelender.ics\"\n                        href={this.state.fileDownloadUrl}\n                        ref={e=>this.dofileDownload = e}\n                    >download it</a>\n                    <button onClick={()=>this.exportIcs(pruefungenExport.replace(\" \", \"\"))}>Export</button>\n                    <h3 id = \"header_overview\">Übersicht</h3>\n\n                    <table id = \"overview_table\">\n                        <thead>\n                            <tr>\n                                {pruefungenHeader}\n                                {/*ToDo: Hier werden die Spaltennamen generiert*/}\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {/*<tr>{this.state.aktiveFilter}</tr>}\n                            {<tr>{this.state.searchItem}</tr>*/}\n                            {pruefungenListe}\n                            {/*rows*/}\n                        </tbody>\n\n                    </table>\n                </div>  \n                </>\n            );\n        }\n    }\n}\n"]},"metadata":{},"sourceType":"module"}